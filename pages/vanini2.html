<!DOCTYPE html>
<html class="full">
    <head>
        <title>vanini2</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
              rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" 
              crossorigin="anonymous">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.js"></script>
        <link href="../common/css/vanini2.css" rel="stylesheet" type="text/css"/>
        <style>
            .full {
                /*background: url(https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/Casa_Giulio_Cesare_Vanini_Taurisano.jpg/1280px-Casa_Giulio_Cesare_Vanini_Taurisano.jpg) no-repeat center center fixed;*/
                background: url('http://www.leccenews24.it/immagini/politica/casagiuliocesarevaninitaurisano.jpg') no-repeat center center fixed;
                -webkit-background-size: cover;
                -moz-background-size: cover;
                -o-background-size: cover;
                background-size: cover;
                margin: 0 auto;
            }
            
            h2 {
                font-size: 2.7em;
            }
        </style>
    </head>
    <body>
<!--        {{#if sites.length}}
                {{#each sites}}
                    <span>{{!this}}</span>
                {{/each}}

            {{/if}}-->
        <script id="example-template" type="text/x-handlebars-template">
            
            {{#each sites}}
            <div class='{{#if @last}}mostra{{else}}hide{{/if}} items notizia'>
                <div class="col-md-5"></div>
                <div class="col-md-7 bg-primary ">
                
                    <h1 class="display-1 title">
                        {{this.titolo}}
                    </h1>

                    <h2 class="text-justify display-2 desc">
                        {{{this.descrizione}}}
                    </h2>
                </div>
                
            </div>
                
            {{/each}}
        
    </script>

        <!--<nav class="navbar navbar-fixed-top" role="navigation">-->
        <!-- <div class="navbar-header logobg bordered"> <div id="logo" class="logobg bordered"></div> </div>-->
        <!--</nav>-->
        
        <div class="container-fluid">
            <br />

            <div class="flex-row">
                <div class="col-md-5"></div>

                <div class="col-md-7 bottom10">
                    <div id="myCarousel" class="hide carousel slide" data-ride="carousel">
                        <!-- Indicators -->
                        <ol class="carousel-indicators">
                            <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                            <li data-target="#myCarousel" data-slide-to="1"></li>
                            <li data-target="#myCarousel" data-slide-to="2"></li>
                        </ol>
                        <div class="carousel-inner" role="listbox">
                            
                            <div class="content-placeholder2"></div>
                            
                            
                            <div class="item active">
                                <img class="first-slide" src="http://wp.contempographicdesign.com/wp_real_estate_3/wp-content/themes/realestate_3/img_resize/timthumb.php?src=http://wp.contempographicdesign.com/wp_real_estate_3/wp-content/uploads/2012/05/condo.png&h=350&w=960&zc=1" alt="First slide" data-pin-nopin="true">
                                <div class="container">
                                    <div class="carousel-caption opabg">

                                        <h1>DISPLAY <span class="text-danger"><strong>hub</strong></span>anero</h1>
                                        <h1>IL NUOVISSIMO DISPLAY INTERATTIVO</h1>

                                    </div>
                                </div>
                            </div>

                            <div class="item">
                                <img class="second-slide" src="http://wp.contempographicdesign.com/wp_real_estate_3/wp-content/themes/realestate_3/img_resize/timthumb.php?src=http://wp.contempographicdesign.com/wp_real_estate_3/wp-content/uploads/2012/05/meridian-condos.jpg&h=350&w=960&zc=1" alt="Second slide">
                                <div class="container">
                                    <div class="carousel-caption opabg">
                                        <h1>CHE CONTROLLI CON IL TUO </h1>
                                        <h1>SMARTPHONE</h1>
                                        <!--<p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>-->
                                        <!--<p><a class="btn btn-lg btn-primary" href="#" role="button">Learn more</a></p>-->
                                    </div>
                                </div>
                            </div>

                            <div class="item">
                                <img class="third-slide" src="http://wp.contempographicdesign.com/wp_real_estate_3/wp-content/themes/realestate_3/img_resize/timthumb.php?src=http://wp.contempographicdesign.com/wp_real_estate_3/wp-content/uploads/2012/05/sandiego.jpg&h=350&w=960&zc=1" alt="Third slide">
                                <div class="container">
                                    <div class="carousel-caption opabg">
                                        <h1>SCOPRILO VISITANDO</h1>
                                        <h1>www.<span class="text-danger"><strong>hub</strong></span>anero.it</h1>
                                        <!--<p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>-->
                                        <!--<p><a class="btn btn-lg btn-primary" href="#" role="button">Browse gallery</a></p>-->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
            </div>
            <div class="flex-row">
                <div class="content-placeholder"></div>
            </div>
        </div>
        <div class="container-fluid panel-transparent">
            <nav class=" navbar navbar-right navbar-fixed-bottom">
                <!--<div class="col-md-10 text-danger bg-warning">-->
                    <div class="col col-md-4 text-danger bg-success offset">
                        <h2 class="text-center text-uppercase">
                            Scuola Primaria "G.C. Vanini" - taurisano
                        </h2>
                        <span  id="title-box-right"></span>
                        <span  id="title-box-left"></span>
                    </div>
                <ul class="offset2">

                    
                </ul>
            </nav>
        </div>
        <script src="/socket.io/socket.io.js"></script>
        <script src="/varSocketURI.js"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js" ></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" ></script>
        
        <script>
            $('.carousel').carousel({
                interval: 5000,
                keyboard: true,
                ride: true,
                pause: "hover"
            });
            $('#myCarousel').on('slide.bs.carousel', function () {
                // do somethingâ€¦
            });
        </script>
        
        <script>
        $(function(){
        var timeToSlideNews = 19000;
        var userID = "00018";
        var items = [];
        var test = [];
        urlJson = 'http://www.di-vision.org/getNews.php?userID=' + userID + '&content_type=my_news&callback=?';
        returnedData = '';
        that = this;
        var srcImages = [
            "http://www.leccenews24.it/immagini/attualita/13361017img0670.jpg",
            "http://static.salento.com/upload/models/original/i-comuni/taurisano-22.jpg",
            "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Chiesa_Santa_Maria_della_Strada_Taurisano.jpg/1200px-Chiesa_Santa_Maria_della_Strada_Taurisano.jpg",
            "https://www.puglia.com/wp-content/uploads/2017/01/taurisano-lecce_-10.jpg",
            "http://rete.comuni-italiani.it/foto/2012/wp-content/uploads/2012/01/10513-800x535.jpg",
            "http://www.piazzasalento.it/wp-content/uploads/2015/06/municipio-di-taurisano-visto-dalle-spalle.jpg"
        ];
            
        function jsonCallback(data) {
            //count = 0;
            $.each(data.sites, function (key, val) {
                console.log(data);
                if (val.titolo !== '') { // avoid empty news
                    items.push();
                }
                else{
                    test.push(this);
                }
                count++;
            });
        }

        function getNews(urlJson) {
            $.ajax({
                type: 'GET',
                url: urlJson,
                crossDomain: true,
                jsonp: false,
                cache: true,
                jsonpCallback: 'jsonCallback',
                dataType: 'jsonp',
                success: function (json) {
                    console.log('get news success!');
                    that.returnedData = json;
                    succ(that.returnedData, to) //to = timeout
                },
                error: function (e) {
                    console.log(e.message);
                }
            });
        };
        
        getNews(urlJson);
            
        var theTemplateScript = $("#example-template").html();

        var theTemplate = Handlebars.compile(theTemplateScript);
        
        function succ(returnedData, callback){
            returnedData.sites.splice(0,1);
//            returnedData.sites.splice(29,1);
//            returnedData.sites.splice(28,1);
               var theCompiledHtml = theTemplate(returnedData);
               $('.content-placeholder').html(theCompiledHtml);
               callback();
        }
        
        count = 4; // random point to start:
        /*
         * remove empty titles
         * first op. to hide elements and start slider
         */
        var to = function(){
            
            $('.title').each(function (){
//                console.log(this);
                if($(this).text().trim() === ""){
                    $(this).parent().parent().remove();
                }
            });
            setTimeout(function(){
                var items = $(".items");
                itemsCount = items.length;
                items.fadeOut(1000);
                item = $(".items").eq(count);
                
//                item.removeClass('hide')
                item.fadeIn(3000);
                item.removeClass('hide');
                
//                all.fadeOut();
//                first.fadeIn();
                
                to2();
            
            }, 2000);
        };
        
        var to2 = function(){
            var si1 = setInterval(function(){
                
                nextNews();
            
            }, timeToSlideNews);
        };
        
        
        $("#title-box-right").click(function(){
            nextNews();
        });
        $("#title-box-left").click(function(){
            prevNews();
        });

        
        function nextNews(){
            console.log('ricevuto');
            goSlide();
            var o = $(".items").eq(count).removeClass("mostra").addClass("hide");
            count == $(".items").length ? count = 0 : count +=1;
            o = $(".items").eq(count).fadeIn();
            o.removeClass('hide');
        }
        
        function prevNews(){
            console.log('ricevuto');
            goSlide();
            var o = $(".items").eq(count).removeClass("mostra").addClass("hide");
            count == 0 ? count = $(".items").length : count -=1;
            o = $(".items").eq(count).fadeIn();
            o.removeClass('hide');
        }
        
        
        
        function startLoop(){
            var items = $('.items');
            itemsCount = items.length;
            test();
        }
        
        function goSlide(){
            
            var a = $( ".notizia h1" );
            var b = $( ".desc" );
            
            b.each(function(x ,y ){
                sdf = $(this).text().toString().replace(/(\r\n|\n|\r)/gm, '');
                
                if(jQuery.trim( sdf) == ""){
                    $(this).remove();
                }
            });
            
            $( ".items h1" ).each(function() {
//                var testoTitolo = jQuery.trim( $('.item').text().toString());
                
                var testoTitolo = $(this).text().toString().replace(/(\r\n|\n|\r)/gm, '');
                qqq = jQuery.trim( testoTitolo);
//                
//                if( qqq.replace(' ', '') == '' )
//                {
//                    alert('oo');
//                    $(this).remove();   
//                }
            });
            var a = $( ".items h1" );
        }
        // slide background images
        var i = 0;
        setInterval(function(){
            i == 5 ? i = 0 : i += 1;
            $('.full').css({
                "background" : 'url('+srcImages[i]+') no-repeat center center fixed',
                "-webkit-background-size" : "cover",
                "-moz-background-size" : "cover",
                "-o-background-size" : "cover",
                "background-size" : "cover",
                "margin" : "0 auto"
            });
        }, 30 * 1000);
        
});
    </script>
    <script src="../client/js/generic.js"></script>
    <script src="../client/js/audio.js"></script>
    </body>
</html>